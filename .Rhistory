stddiff.numeric(group1$hr, group2$hr)
stddiff.numeric(data=group1,gcol=1,vcol=c(2,2))
total <- merge(group1,group2,by="name")
total
total
total <- rbind(group1, group2)
total
stddiff.numeric(data=total,gcol=1,vcol=2)
,2
stddiff.numeric(data=total,gcol=1,vcol=c(2,2))
stddiff.numeric(data=total,gcol=2,vcol=1)
# Create an array filled with the value 5
length(sheimaa_microbit)
length(sheimaa_watch)
microbit_vals <- array(1, dim = 39)
print(microbit_vals)
watch_vals <- array(0, dim = 39)
print(watch_vals)
group1 <- data.frame(hr = sheimaa_microbit, name = microbit_vals)
# Create an array filled with the value 5
length(sheimaa_microbit)
length(sheimaa_watch)
microbit_vals <- array(1, dim = 40)
print(microbit_vals)
watch_vals <- array(0, dim = 40)
print(watch_vals)
group1 <- data.frame(hr = sheimaa_microbit, name = microbit_vals)
group2 <- data.frame(hr = sheimaa_watch, name = watch_vals)
total <- rbind(group1, group2)
total
stddiff.numeric(data=total,gcol=2,vcol=1)
corr_ines <- cor(ines_microbit, ines_watch, method = "pearson")
corr_ines
corr_sheimaa <- cor(sheimaa_microbit, sheimaa_watch, method = "pearson")
corr_sheimaa
library(ggplot2)
library(dplyr)
install.packages("BlandAltmanLeh")
library(BlandAltmanLeh)
install.packages("effsize")
install.packages("MethodCompare")
library(effsize)
library(MethodCompare)
install.packages("stddiff")
library(stddiff)
library(ggplot2)
library(dplyr)
install.packages("BlandAltmanLeh")
install.packages("BlandAltmanLeh")
ines_microbit <- c(71,71,67,75,72,71,70,75,73,79,96,78,
87,91,100,88,85,102,78,92,102,76,93,78,
73,80,79,88,83,79,82,87,98,89,77,78,76,79,83)
ines_watch <- c(65,77,78,75,75,78,75,75,76,82,78,81,82,70,
74,81,81,85,81,89,82,76,78,80,70,84,76,79,
91,81,83,85,89,96,88,90,79,78,80)
sheimaa_microbit <- c(86,89,75,80,89,83,67,67,67,67,67,
70,67,71,69,69,73,68,63,64,77,72,
70,67,68,68,69,72,81,69,66,65,67,
83,70,71,69,73,76,69)
sheimaa_watch <- c(74,68,65,64,65,73,62,61,65,64,67,66,
66,70,72,71,73,71,67,64,68,74,70,66,
67,69,70,72,78,66,67,65,69,71,69,
72,71,72,74,70)
summary(sheimaa_microbit)
# Summary statistics
summary(sheimaa_microbit)
summary(sheimaa_microbit)
# Standard Deviation
sd(ines_watch)
# Standard Deviation
sd(ines_microbit)
# Standard Deviation
sd(sheimaa_watch)
# Standard Deviation
sd(sheimaa_microbit)
mean_diff_ines <- bias <- mean(ines_watch - ines_microbit)
mean_diff_ines
mean_diff_ines  <- mean(ines_watch - ines_microbit)
mean_diff_ines
mean_diff  <- mean(ines_watch - ines_microbit)
mean_diff
mean_diff2  <- mean(sheimaa_watch - sheimaa_microbit)
mean_diff2
# Because they have unequal variances, use Welch's t-test
t.test(sheimaa_watch, sheimaa_microbit, alternative = "two.sided", var.equal = FALSE)
# Because they have unequal variances, use Welch's t-test
t.test(ines_watch, ines_microbit, alternative = "two.sided", var.equal = FALSE)
mean_values <- (ines_watch + ines_microbit) / 2
differences <- ines_watch - ines_microbit
# Plot
plot(mean_values, differences,
xlab = "Mean of Two Methods",
ylab = "Difference Between Methods",
main = "Bland-Altman Plot", ylim = c(-30,30))
abline(h = mean(differences), col = "blue")  # Mean difference
abline(h = mean(differences) + 1.96 * sd(differences), col = "red", lty = 2)  # Upper limit
abline(h = mean(differences) - 1.96 * sd(differences), col = "red", lty = 2)  # Lower limit
mean_values <- (ines_watch + ines_microbit) / 2
differences <- ines_watch - ines_microbit
# Plot
plot(mean_values, differences,
xlab = "Mean of Two Methods",
ylab = "Difference Between Methods",
main = "Bland-Altman Plot Subject I", ylim = c(-30,30))
abline(h = mean(differences), col = "blue")  # Mean difference
abline(h = mean(differences) + 1.96 * sd(differences), col = "red", lty = 2)  # Upper limit
abline(h = mean(differences) - 1.96 * sd(differences), col = "red", lty = 2)  # Lower limit
# Bland-Altman Plot
mean_values <- (sheimaa_watch + sheimaa_microbit) / 2
differences <- sheimaa_watch - sheimaa_microbit
# Plot
plot(mean_values, differences,
xlab = "Mean of Two Methods",
ylab = "Difference Between Methods",
main = "Bland-Altman Plot Subject S", ylim = c(-30,20))
abline(h = mean(differences), col = "blue")  # Mean difference
abline(h = mean(differences) + 1.96 * sd(differences), col = "red", lty = 2)  # Upper limit
abline(h = mean(differences) - 1.96 * sd(differences), col = "red", lty = 2)  # Lower limit
# Plot
plot(mean_values, differences,
xlab = "Mean of Two Methods",
ylab = "Difference Between Methods",
main = "Bland-Altman Plot Subject S", ylim = c(-30,20))
abline(h = mean(differences), col = "blue")  # Mean difference
abline(h = mean(differences) + 1.96 * sd(differences), col = "red", lty = 2)  # Upper limit
abline(h = mean(differences) - 1.96 * sd(differences), col = "red", lty = 2)  # Lower limit
mean(differences) + 1.96 * sd(differences)
mean(differences) - 1.96 * sd(differences)
# Bland-Altman plots
# Calculate mean and difference
mean_values <- (ines_watch + ines_microbit) / 2
differences <- ines_watch - ines_microbit
# Plot
plot(mean_values, differences,
xlab = "Mean of Two Methods",
ylab = "Difference Between Methods",
main = "Bland-Altman Plot Subject I", ylim = c(-30,30))
abline(h = mean(differences), col = "blue")  # Mean difference
abline(h = mean(differences) + 1.96 * sd(differences), col = "red", lty = 2)  # Upper limit
abline(h = mean(differences) - 1.96 * sd(differences), col = "red", lty = 2)  # Lower limit
mean(differences) - 1.96 * sd(differences)
mean(differences) + 1.96 * sd(differences)
library(ggplot2)
library(geomtextpath)
# Do analysis of LYSO measurements
dist <- c(110,120,130,140,150,160,170,180,190,200)
cps_1 <- c(9897,7116,6771,5458,4247,4016,3652,3254,3008,2325)
cps_2 <- c(101855,68992,58675,44285,33487,30933,27759,24504,22914,16677)
cps_ratio <- cps_2/cps_1
cps_ratio
dr_1 <- c(353.39,253.96,240.66,190.73,153.34,139.34,129.09,113.34,108.83,81.22)
dr_2 <-c(404.87,249.49,240.94,189.78,152.02,138.62,128.23,113.51,108.65,81.6)
dr_3 <- c(1700,1350,1250,1020,836,748,732,655,642,487)
data <- data.frame(
cps_1 = cps_1,
cps_2 = cps_2,
cps_ratio = cps_ratio,
dr_1 = dr_1,
dr_2 = dr_2,
dr_3 = dr_3,
dist = dist
)
data
# Counts Per Second Comparison
ggplot(data=data, aes(x=dist)) +
geom_line(aes(y = cps_1,color = "25mm²"))+ geom_point(aes(y=cps_1), color = "blue") +
geom_line(aes(y = cps_2, color = "4mm²"))+ geom_point(aes(y=cps_2), color = "red") +
ggtitle("Counts Per Second vs Distance") + labs(
title = "Counts per Second vs Distance",
x = "Distance (cm)",
y = "Counts per second (cps)")+
theme_minimal(base_size = 14) + theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(
values = c("25mm²" = "blue", "4mm²" = "red"), name = "LYSO Crystal Size"
)
# Counts Per Second Comparison
ggplot(data=data, aes(x=dist)) +
geom_line(aes(y = cps_1,color = "25mm²"))+ geom_point(aes(y=cps_1), color = "blue") +
geom_line(aes(y = cps_2, color = "4mm²"))+ geom_point(aes(y=cps_2), color = "red") +
ggtitle("Counts Per Second vs Distance") + labs(
title = "Counts per Second vs Distance",
x = "Distance (cm)",
y = "Counts per second (cps)")+
theme_minimal(base_size = 14) + theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(
values = c("25mm²" = "blue", "4mm²" = "red"), name = "LYSO Crystal Size"
)
# Dose Rates Comparison
ggplot(data=data, aes(x=dist)) +
geom_line(aes(y = dr_1,color="25mm²"))+ geom_point(aes(y=dr_1), color="blue") +
geom_line(aes(y = dr_2,color="4mm²"))+ geom_point(aes(y=dr_2), color = "red") +
ggtitle("Counts Per Second by Distance") + labs(
title = "Dose Rate vs Distance",
x = "Distance (cm)",
y = "Dose Rate (μSv/h)")+
theme_minimal(base_size = 14) + theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(
values = c("25mm²" = "blue", "4mm²" = "red"), name = "LYSO Crystal Size"
)
# CPS Ratio
ggplot(data=data, aes(x=dist)) +
geom_line(aes(y = cps_ratio,color="CPS Ratio"))+ geom_point(aes(y=cps_ratio), color="blue") +
ggtitle("Counts Per Second Ratio") + labs(
title = "Counts Per Second Ratio vs Distance",
x = "Distance (cm)",
y = "Counts Per Second Ratio")+
theme_minimal(base_size = 14) + theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(
values = c("CPS Ratio" = "black"), name = ""
)
# Scatterplot
ggplot(data, aes(x=cps_1, y=cps_2)) +
geom_point( color="darkgreen") +
labs(
title = "Counts Per Second Correlation",
x = "CPS of 25mm² LYSO",
y = "CPS of 4mm² LYSO") +
geom_abline(slope=1, intercept=0, linetype = "dashed")
# Scatterplot
ggplot(data, aes(x=dr_1, y=dr_2)) +
geom_point( color="darkgreen") +
labs(
title = "Dose Rate Correlation",
x = "CPS of 25mm² LYSO",
y = "CPS of 4mm² LYSO") +
geom_abline(slope=1, intercept=0, linetype = "dashed")
# Scatterplot
ggplot(data, aes(x=dr_1, y=dr_2)) +
geom_point( color="darkgreen") +
labs(
title = "Dose Rate Correlation",
x = "CPS of 25mm² LYSO",
y = "CPS of 4mm² LYSO") +
geom_abline(slope=1, intercept=0, linetype = "dashed") +
theme_minimal(base_size = 14) + theme(plot.title = element_text(hjust = 0.5))
# Scatterplot
ggplot(data, aes(x=cps_1, y=cps_2)) +
geom_point( color="darkgreen") +
labs(
title = "Counts Per Second Correlation",
x = "CPS of 25mm² LYSO",
y = "CPS of 4mm² LYSO") +
geom_abline(slope=1, intercept=0, linetype = "dashed")
# Scatterplot
ggplot(data, aes(x=dr_1, y=dr_2)) +
geom_point( color="darkgreen") +
labs(
title = "Dose Rate Correlation",
x = "CPS of 25mm² LYSO",
y = "CPS of 4mm² LYSO") +
geom_abline(slope=1, intercept=0, linetype = "dashed") +
theme_minimal(base_size = 14) + theme(plot.title = element_text(hjust = 0.5))
# Scatterplot
ggplot(data, aes(x=cps_1, y=cps_2)) +
geom_point( color="darkgreen") +
labs(
title = "Counts Per Second Correlation",
x = "CPS of 25mm² LYSO",
y = "CPS of 4mm² LYSO") +
geom_abline(slope=1, intercept=0, linetype = "dashed") +
theme_minimal(base_size = 14) + theme(plot.title = element_text(hjust = 0.5))
# Scatterplot
ggplot(data, aes(x=cps_1, y=cps_2)) +
geom_point( color="darkgreen") +
labs(
title = "Counts Per Second Correlation",
x = "CPS of 25mm² LYSO",
y = "CPS of 4mm² LYSO") +
geom_abline(slope=1, intercept=0, linetype = "dashed") +
theme_minimal(base_size = 14) + theme(plot.title = element_text(hjust = 0.5))
# Scatterplot
ggplot(data, aes(x=dr_1, y=dr_2)) +
geom_point( color="darkgreen") +
labs(
title = "Dose Rate Correlation",
x = "CPS of 25mm² LYSO",
y = "CPS of 4mm² LYSO") +
geom_abline(slope=1, intercept=0, linetype = "dashed") +
theme_minimal(base_size = 14) + theme(plot.title = element_text(hjust = 0.5))
# Scatterplot
ggplot(data, aes(x=cps_1, y=cps_2)) +
geom_point( color="darkgreen") +
labs(
title = "Counts Per Second",
x = "CPS of 25mm² LYSO",
y = "CPS of 4mm² LYSO") +
geom_abline(slope=1, intercept=0, linetype = "dashed") +
theme_minimal(base_size = 14) + theme(plot.title = element_text(hjust = 0.5))
# Scatterplot
ggplot(data, aes(x=cps_1, y=cps_2)) +
geom_point( color="darkgreen") +
labs(
title = "Counts Per Second",
x = "CPS of 25mm² LYSO",
y = "CPS of 4mm² LYSO") + geom_abline(slope=1, intercept=0, linetype = "dashed") +
theme_minimal(base_size = 14) + theme(plot.title = element_text(hjust = 0.5))
# Scatterplot
ggplot(data, aes(x=cps_1, y=cps_2)) +
geom_point( color="darkgreen") +
labs(
title = "Counts Per Second",
x = "CPS of 25mm² LYSO",
y = "CPS of 4mm² LYSO") + geom_abline(slope=1, intercept=25000, linetype = "dashed") +
theme_minimal(base_size = 14) + theme(plot.title = element_text(hjust = 0.5))
# Scatterplot
ggplot(data, aes(x=cps_1, y=cps_2)) +
geom_point( color="darkgreen") +
labs(
title = "Counts Per Second",
x = "CPS of 25mm² LYSO",
y = "CPS of 4mm² LYSO") + geom_smooth() +
theme_minimal(base_size = 14) + theme(plot.title = element_text(hjust = 0.5))
# Scatterplot
ggplot(data, aes(x=cps_1, y=cps_2)) +
geom_point( color="darkgreen") +
labs(
title = "Counts Per Second",
x = "CPS of 25mm² LYSO",
y = "CPS of 4mm² LYSO") + geom_smooth(linetype="dashed") +
theme_minimal(base_size = 14) + theme(plot.title = element_text(hjust = 0.5))
# Scatterplot
ggplot(data, aes(x=cps_1, y=cps_2)) +
geom_point( color="darkgreen") +
labs(
title = "Counts Per Second",
x = "CPS of 25mm² LYSO",
y = "CPS of 4mm² LYSO") + geom_smooth(linetype="dashed", color = black) +
theme_minimal(base_size = 14) + theme(plot.title = element_text(hjust = 0.5))
# Scatterplot
ggplot(data, aes(x=cps_1, y=cps_2)) +
geom_point( color="darkgreen") +
labs(
title = "Counts Per Second",
x = "CPS of 25mm² LYSO",
y = "CPS of 4mm² LYSO") + geom_smooth(linetype="dashed") +
theme_minimal(base_size = 14) + theme(plot.title = element_text(hjust = 0.5))
# Scatterplot
ggplot(data, aes(x=cps_1, y=cps_2)) +
geom_point( color="darkgreen") +
labs(
title = "Counts Per Second",
x = "Dose Rate of 25mm² LYSO (μSv/h)",
y = "Dose Rate of 4mm² LYSO (μSv/h)") + geom_smooth(linetype="dashed") +
theme_minimal(base_size = 14) + theme(plot.title = element_text(hjust = 0.5))
getwd()
setwd("2025/KTH/Studies/")
setwd("Statistics for Medical Engineering")
setwd("Seminar 4")
setwd("cm2018_ht25_seminar_4_b2")
getwd()
draw_confusion_matrix <- function(cm) {
total <- sum(cm$table)
res <- as.numeric(cm$table)
# Generate color gradients. Palettes come from RColorBrewer.
greenPalette <- c("#F7FCF5","#E5F5E0","#C7E9C0","#A1D99B","#74C476","#41AB5D","#238B45","#006D2C","#00441B")
redPalette <- c("#FFF5F0","#FEE0D2","#FCBBA1","#FC9272","#FB6A4A","#EF3B2C","#CB181D","#A50F15","#67000D")
getColor <- function (greenOrRed = "green", amount = 0) {
if (amount == 0)
return("#FFFFFF")
palette <- greenPalette
if (greenOrRed == "red")
palette <- redPalette
colorRampPalette(palette)(100)[10 + ceiling(90 * amount / total)]
}
# set the basic layout
layout(matrix(c(1,1,2)))
par(mar=c(2,2,2,2))
plot(c(100, 345), c(300, 450), type = "n", xlab="", ylab="", xaxt='n', yaxt='n')
title('CONFUSION MATRIX', cex.main=2)
# create the matrix
classes = colnames(cm$table)
rect(150, 430, 240, 370, col=getColor("green", res[1]))
text(195, 435, classes[1], cex=1.2)
rect(250, 430, 340, 370, col=getColor("red", res[3]))
text(295, 435, classes[2], cex=1.2)
text(125, 370, 'Predicted', cex=1.3, srt=90, font=2)
text(245, 450, 'Actual', cex=1.3, font=2)
rect(150, 305, 240, 365, col=getColor("red", res[2]))
rect(250, 305, 340, 365, col=getColor("green", res[4]))
text(140, 400, classes[1], cex=1.2, srt=90)
text(140, 335, classes[2], cex=1.2, srt=90)
# add in the cm results
text(195, 400, res[1], cex=1.6, font=2, col='white')
text(195, 335, res[2], cex=1.6, font=2, col='white')
text(295, 400, res[3], cex=1.6, font=2, col='white')
text(295, 335, res[4], cex=1.6, font=2, col='white')
# add in the specifics
plot(c(100, 0), c(100, 0), type = "n", xlab="", ylab="", main = "DETAILS", xaxt='n', yaxt='n')
text(10, 85, names(cm$byClass[1]), cex=1.2, font=2)
text(10, 70, round(as.numeric(cm$byClass[1]), 3), cex=1.2)
text(30, 85, names(cm$byClass[2]), cex=1.2, font=2)
text(30, 70, round(as.numeric(cm$byClass[2]), 3), cex=1.2)
text(50, 85, names(cm$byClass[5]), cex=1.2, font=2)
text(50, 70, round(as.numeric(cm$byClass[5]), 3), cex=1.2)
text(70, 85, names(cm$byClass[6]), cex=1.2, font=2)
text(70, 70, round(as.numeric(cm$byClass[6]), 3), cex=1.2)
text(90, 85, names(cm$byClass[7]), cex=1.2, font=2)
text(90, 70, round(as.numeric(cm$byClass[7]), 3), cex=1.2)
# add in the accuracy information
text(30, 35, names(cm$overall[1]), cex=1.5, font=2)
text(30, 20, round(as.numeric(cm$overall[1]), 3), cex=1.4)
text(70, 35, names(cm$overall[2]), cex=1.5, font=2)
text(70, 20, round(as.numeric(cm$overall[2]), 3), cex=1.4)
}
library(irr)
library(dplyr)
library(caret)
library(blandr)
library(ggplot2)
data <- read.csv("data/data_t1.csv")
data
# Process the data
str(data)
rater_data <- data[c("Rater1","Rater2")]
rater_data
# Create visualizations for the data
barplot(colSums(rater_data), ylab = "Positive Ratings")
barplot(rowSums(rater_data), ylab = "Positive Ratings")
# Create visualizations for the data
barplot(colSums(rater_data), ylab = "Positive Ratings")
# Create visualizations for the data
barplot(colSums(rater_data), ylab = "Positive Ratings", main = "Positive Ratings")
barplot(rowSums(rater_data), ylab = "Positive Ratings")
# Create visualizations for the data
rater_data
barplot(rowSums(rater_data), ylab = "Positive Ratings", col="#69b3a2")
barplot(colSums(rater_data), ylab = "Positive Ratings", main = "Positive Ratings")
barplot(rowSums(rater_data), ylab = "Positive Ratings", col="#69b3a2", main="Patient Ratings")
barplot(rowSums(rater_data), ylab = "Ratings", col="#69b3a2", main="Patient Ratings")
barplot(rowSums(rater_data), ylab = "Sum of Ratings", col="#69b3a2", main="Patient Ratings")
barplot(rowSums(rater_data), ylab = "Sum of Ratings", col="#69b3a2", main="Patient Ratings", names.arg=c("group1","group2","group3","group4","group5"),)
barplot(colSums(rater_data), ylab = "Positive Ratings", main = "Positive Ratings")
barplot(rowSums(rater_data), ylab = "Sum of Ratings", col="#69b3a2", main="Patient Ratings", names.arg=seq(1, 100, by=1))
barplot(rowSums(rater_data), ylab = "Sum of Ratings", col="#69b3a2", main="Ratings for Each ID", names.arg=seq(1, 100, by=1))
barplot(rowSums(rater_data), ylab = "Sum of Ratings", col="#69b3a2", main="Ratings for Each Patient ID", names.arg=seq(1, 100, by=1))
t1_mat <- as.matrix(rater_data)
image(t1_mat)
# Kappa Fleiss Model
k_fleiss <- kappam.fleiss(rater_data)
k_fleiss
# Kappa 2 Model
kappa2(rater_data)
# Kappa 2 Model
kappa2(rater_data)
# Create confusion matrix for further calculations
rater_data[c("Rater1")]
# Check levels
real_results <- as.list(data[c("Patient_Diagnosis")])
rater1 <- as.list(data[c("Rater1")])
rater2 <- as.list(data[c("Rater2")])
# Ensure factors have the same levels as the real results
levels_all <- unique(c(real_results, rater1, rater2))
real_results <- factor(real_results, levels = levels_all)
rater1       <- factor(rater1, levels = levels_all)
rater2       <- factor(rater2, levels = levels_all)
cat("Confusion Matrix: Rater 1 vs Real Results\n")
cm_rater1 <- confusionMatrix(as.factor(data$Rater1), as.factor(data$Patient_Diagnosis))
print(cm_rater1)
draw_confusion_matrix(cm_rater1)
cat("Confusion Matrix: Rater 1 vs Real Results\n")
cm_rater1 <- confusionMatrix(as.factor(data$Rater1), as.factor(data$Patient_Diagnosis), positive = 1)
cat("Confusion Matrix: Rater 1 vs Real Results\n")
cm_rater1 <- confusionMatrix(as.factor(data$Rater1), as.factor(data$Patient_Diagnosis), positive = "1")
print(cm_rater1)
draw_confusion_matrix(cm_rater1)
cat("Confusion Matrix: Rater 1 vs Real Results\n")
cm_rater1 <- confusionMatrix(as.factor(data$Rater1), as.factor(data$Patient_Diagnosis), positive = "1")
print(cm_rater1)
draw_confusion_matrix(cm_rater1)
cm_rater1 <- confusionMatrix(as.factor(data$Rater1), as.factor(data$Patient_Diagnosis), positive = "0")
print(cm_rater1)
cat("Confusion Matrix: Rater 1 vs Real Results\n")
cm_rater1 <- confusionMatrix(as.factor(data$Rater1), as.factor(data$Patient_Diagnosis), positive = "1")
print(cm_rater1)
cat("Confusion Matrix: Rater 2 vs Real Results\n")
cm_rater2 <- confusionMatrix(as.factor(data$Rater2), as.factor(data$Patient_Diagnosis), positive = "1")
print(cm_rater2)
draw_confusion_matrix(cm_rater2)
# Draw ROC curves
install.packages("PRROC")
# Intra Class
icc(rater_data)
# Do Bland-Altman plots for comparison
differences <- data$Rater1 - data$Rater2
averages <- (data$Rater1 + data$Rater2) / 2
mean_diff <- mean(differences, na.rm = TRUE)
sd_diff <- sd(differences, na.rm = TRUE)
upper_limit <- mean_diff + 1.96 * sd_diff
lower_limit <- mean_diff - 1.96 * sd_diff
plot(averages, differences, pch = 19)
abline(h = mean_diff, col = "blue", lwd = 2)
abline(h = upper_limit, col = "red", lty = 2)
abline(h = lower_limit, col = "red", lty = 2)
percentage_error <- (upper_limit - lower_limit) / mean(averages, na.rm = TRUE) * 100
cat("Percentage Error:", round(percentage_error, 2), "%\n")
# BLANDR
blandr.draw(data$Rater1,data$Rater2)
cat("Percentage Error:", round(percentage_error, 2), "%\n")
percentage_error <- (upper_limit - lower_limit) / mean(averages, na.rm = TRUE) * 100
cat("Percentage Error:", round(percentage_error, 2), "%\n")
# Kappa 2 Model
kappa2(rater_data)
cat("Confusion Matrix: Rater 2 vs Real Results\n")
cm_rater2 <- confusionMatrix(as.factor(data$Rater2), as.factor(data$Patient_Diagnosis), positive = "1")
print(cm_rater2)
cat("Confusion Matrix: Rater 1 vs Real Results\n")
cm_rater1 <- confusionMatrix(as.factor(data$Rater1), as.factor(data$Patient_Diagnosis), positive = "1")
print(cm_rater1)
library(lme4)
library(lme4)
library(lme4)
data
